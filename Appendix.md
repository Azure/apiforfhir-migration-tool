# Appendix

## Additional Azure API for FHIR Prep to do specific to Migration Tool

If you are planning to use the migration tool, please take note of these additional steps to take when preparing your Azure API for FHIR server for migration:

-   The tool consumes resources, so if you want it to run as fast as it can, cancel all non-business critical jobs (like reindexing or large imports) if you can.
-   If your current Azure API for FHIR server has autoscaling turned on, \$export on a large amount of data may boost your RU and increase your cost. If you’d like to change from autoscale to fixed, please file a CSS support ticket to turn autoscaling off.
-   If you don’t already have a storage account set up for exports, choose a storage account to export to in Azure Portal under the “Export” tab for the Azure API for FHIR resource.

### Eventing

-   The migration tool will put all the exports from Azure API for FHIR into one container called “Migration” in the storage account that is specified for export. If you currently are using eventing for your Azure API for FHIR service and have a filter on EventGrid that tracks your \$export storage account, be sure to exclude the “Migration” container so that it does not interfere with your existing eventing set up.

## Configurations to set in your new Azure Health Data Services FHIR Server

As you set up your new Azure Health Data Services FHIR Service server, you may want to use the same configurations that you had in Azure API for FHIR for your new Azure Health Data Services FHIR Service server. If so, here are some recommended configurations to note. Some configurations can be set up during the Azure Health Data Services FHIR Service deployment process ([Deploy a FHIR service within Azure Health Data Services \| Microsoft Learn)](https://learn.microsoft.com/en-us/azure/healthcare-apis/fhir/fhir-portal-quickstart) . Others can be set up post-migration in Azure Portal.

In your Azure API for FHIR server on Azure Portal, go to the “Properties” tab. Here you will see a list of your curent Azure API for FHIR configurations. The following table details when and where to set up the corresponding same configurations in Azure Health Data Services FHIR Service, if you’d like to set up the same configurations.

| Configuration                                            | When to configure                                                                                                          | Where to configure                                                                                                                                                                                                    | Notes                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
|----------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Location                                                 | Pre-migration                                                                                                              | During FHIR server deployment                                                                                                                                                                                         |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| FHIR version                                             | Pre-migration                                                                                                              | During FHIR server deployment                                                                                                                                                                                         |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| Private Link                                             | Pre-migration Please follow instructions here (insert link for Private Link instructions – TODO Xoriant) for Private Link. | Please follow instructions here (insert link for Private Link instructions – TODO Xoriant) for Private Link.                                                                                                          |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| Authentication: Authority, Audience, Allowed Object ID’s | Pre-migration                                                                                                              | During FHIR server deployment                                                                                                                                                                                         |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| RBAC and Custom Authority                                | Post-migration                                                                                                             | In Azure Portal under “Access control (IAM)” tab                                                                                                                                                                      |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| SMART on FHIR                                            | Either pre- or post-migration                                                                                              | Pre: During FHIR server deployment Post: In Azure Portal  Please refer to [SMART on FHIR - Azure Health Data Services \| Microsoft Learn](https://learn.microsoft.com/en-us/azure/healthcare-apis/fhir/smart-on-fhir) | Note: SMART on FHIR proxy is being deprecated. You will need to use the new SMARt on FHIR capability. Please see [SMART on FHIR - Azure Health Data Services \| Microsoft Learn](https://learn.microsoft.com/en-us/azure/healthcare-apis/fhir/smart-on-fhir) for more information.                                                                                                                                                                                                                                                                         |
| Provisioned throughout (RU/s)                            | N/A, this is only applicable to Azure API for FHIR                                                                         |                                                                                                                                                                                                                       |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| Customer Managed Key                                     | N/A, this is not available in Azure Health Data Services FHIR Service yet (in the roadmap)                                 |                                                                                                                                                                                                                       | Note: CMK is not available in Azure Health Data Services FHIR Service yet (in the roadmap)                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| Tags                                                     | Either pre- or post-migration                                                                                              | Pre: During FHIR server deployment Post: In “Tags” tab                                                                                                                                                                |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| Versioning Policy                                        | Pre-migration                                                                                                              | During FHIR server deployment                                                                                                                                                                                         | Note: The migration tool currently does not support migrating historical versions (in the roadmap)                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| CORS                                                     | Post-migration                                                                                                             | In Azure Portal under “CORS” tab                                                                                                                                                                                      |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| Managed Identity                                         | Post-migration                                                                                                             | In Azure Portal under “Identity” tab                                                                                                                                                                                  |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| Storage account for export                               | Post-migration                                                                                                             | In Azure Portal in the “Export” tab                                                                                                                                                                                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| ACR Container                                            | Post-migration                                                                                                             | In Azure Portal under “Artifacts” tab                                                                                                                                                                                 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| Profiles                                                 | Post-migration                                                                                                             | Re-upload profiles into new FHIR server                                                                                                                                                                               |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| Custom search parameters                                 | Post-migration (see note)                                                                                                  |                                                                                                                                                                                                                       | Note: Custom search parameters that are in the source FHIR server prior to the migration will be automatically brought over to Azure Health Data Services FHIR Service with the migration tool If you add any custom search parameters after the migration tool has started, it will not be brought over. You will need to query Azure API for FHIR for the new search parameters as a bundle, POST those to Azure Health Data Services FHIR Service, then run a reindex for them to work.                                                                 |
| Client Registration                                      | Post-migration                                                                                                             | In Azure Portal under “Access control (IAM)” tab                                                                                                                                                                      |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| Eventing                                                 | Post-migration                                                                                                             | Please see Eventing overview here [What are Events? - Azure Health Data Services \| Microsoft Learn](https://learn.microsoft.com/en-us/azure/healthcare-apis/events/events-overview)                                  | During migration, eventing in Azure API for FHIR can continue. Please make sure to see our note on Eventing above (link to above eventing note) Make sure eventing in Azure Health Data Services FHIR Service server is turned off during migration. You can turn on eventing in Azure Health Data Services FHIR Service only after the cutover and migration has finished. Please refer here to learn more about [eventing](https://learn.microsoft.com/en-us/azure/healthcare-apis/events/events-overview) in Azure Health Data Services FHIR Service.   |
| Sync Agent for Dataverse                                 |                                                                                                                            |                                                                                                                                                                                                                       | Sync Agent is being deprecated. If you were using Sync Agent to connect to Dataverse, please see [Overview of Data integration toolkit \| Microsoft Learn](https://learn.microsoft.com/en-us/dynamics365/industry/healthcare/data-integration-toolkit-overview?toc=%2Findustry%2Fhealthcare%2Ftoc.json&bc=%2Findustry%2Fbreadcrumb%2Ftoc.json)                                                                                                                                                                                                             |

## 


