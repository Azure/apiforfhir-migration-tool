{
    "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
    "contentVersion": "1.0.0.0",
    "metadata": {
        "_generator": {
            "name": "bicep",
            "version": "0.15.31.15270",
            "templateHash": "11861629922040246994"
        }
    },
    "parameters": {
        "prefix": {
            "type": "string",
            "defaultValue": "mig",
            "metadata": {
                "description": "Prefix for all resources"
            }
        },
        "fhirServiceName": {
            "type": "string",
            "defaultValue": "",
            "metadata": {
                "description": "Name of the FHIR Service, destination for migration. Format is \"workspace/fhirService\"."
            }
        },
        "apiForFhirName": {
            "type": "string",
            "defaultValue": "",
            "metadata": {
                "description": "Name of the API for FHIR, source for migration."
            }
        },
        "appName": {
            "type": "string",
            "defaultValue": "FhirMigrationTool",
            "metadata": {
                "description": "The name of the function app that you wish to create."
            }
        },
        "storageAccountType": {
            "type": "string",
            "defaultValue": "Standard_LRS",
            "allowedValues": [
                "Standard_LRS",
                "Standard_GRS",
                "Standard_RAGRS"
            ],
            "metadata": {
                "description": "Storage Account type"
            }
        },
        "location": {
            "type": "string",
            "defaultValue": "[resourceGroup().location]",
            "metadata": {
                "description": "Location for all resources."
            }
        },
        "appInsightsLocation": {
            "type": "string",
            "defaultValue": "[resourceGroup().location]",
            "metadata": {
                "description": "Location for Application Insights"
            }
        },
        "fhirid": {
            "type": "string",
            "defaultValue": "",
            "metadata": {
                "description": "FHIR Server ID"
            }
        },
        "apiForFhirid": {
            "type": "string",
            "defaultValue": "",
            "metadata": {
                "description": "API for FHIR Server id"
            }
        },
        "dashboardName": {
            "type": "string",
            "defaultValue": "MigrationToolDashboard",
            "metadata": {
                "description": "Name of dashboard."
            }
        },
        "exportWithHistory": {
            "type": "bool",
            "defaultValue": true,
            "metadata": {
                "description": "Export With History"
            }
        },
        "exportWithDelete": {
            "type": "bool",
            "defaultValue": true,
            "metadata": {
                "description": "Export With Delete"
            }
        },
        "isParallel": {
            "type": "bool",
            "defaultValue": true,
            "metadata": {
                "description": "Export Using isParallel"
            }
        },
        "exportDeidentified":{
            "type": "bool",
            "defaultValue": false,
            "metadata": {
                "description": "Export deidentified data"
            }
        },
        "configFile": {
            "type": "string",
            "defaultValue": "",
            "metadata": {
                "description": "Name of Configuration file"
            }
        }
    },
    "variables": {
        "functionAppName": "[format('{0}{1}',parameters('prefix'), parameters('appName'))]",
        "appTags": {
             "AppID": "fhir-migration-tool"
        },
        "logAnalyticsName": "[format('{0}{1}-la', parameters('prefix'), parameters('appName'))]",
        "hostingPlanName": "[format('{0}{1}', parameters('prefix'), parameters('appName'))]",
        "applicationInsightsName": "[format('ai{0}{1}', parameters('prefix'), parameters('appName'))]",
        "storageAccountName": "[format('{0}stor', variables('prefixNameCleanShort'))]",
        "array": "[split(parameters('fhirServiceName'), '/')]",
        "serviceName": "[variables('array')[1]]",
        "workspaceName": "[variables('array')[0]]",
        "fhirsegments": "[split(parameters('fhirid'), '/')]",
        "apiForfhirsegments": "[split(parameters('apiForFhirid'), '/')]",
        "fhirRg": "[variables('fhirsegments')[4]]",
        "apiForFhirRg": "[variables('apiForfhirsegments')[4]]",
        "fhirsubid": "[variables('fhirsegments')[2]]",
        "apiForFhirsubid": "[variables('apiForfhirsegments')[2]]",
        "repoUrl": "https://github.com/Azure/apiforfhir-migration-tool/",
        "uniqueResourceIdentifier": "[substring(uniqueString(resourceGroup().id, parameters('prefix')), 0, 4)]",
        "prefixNameClean": "[format('{0}{1}', replace(parameters('prefix'), '-', ''), variables('uniqueResourceIdentifier'))]",
        "prefixNameCleanShort": "[if(greater(length(variables('prefixNameClean')), 16), substring(variables('prefixNameClean'), 0, 8), variables('prefixNameClean'))]"

    },
    "resources": [
        {
            "type": "Microsoft.Web/sites/basicPublishingCredentialsPolicies",
            "apiVersion": "2021-03-01",
            "name": "[format('{0}/{1}', variables('functionAppName'), 'ftp')]",
            "location": "[parameters('location')]",
            "properties": {
                "allow": false
            },
            "dependsOn": [
                "[resourceId('Microsoft.Web/sites', variables('functionAppName'))]"
            ]
        },
        {
            "type": "Microsoft.Web/sites/basicPublishingCredentialsPolicies",
            "apiVersion": "2021-03-01",
            "name": "[format('{0}/{1}', variables('functionAppName'), 'scm')]",
            "location": "[parameters('location')]",
            "properties": {
                "allow": false
            },
            "dependsOn": [
                "[resourceId('Microsoft.Web/sites', variables('functionAppName'))]"
            ]
        },
        {
            "type": "Microsoft.Storage/storageAccounts",
            "apiVersion": "2022-05-01",
            "name": "[variables('storageAccountName')]",
            "location": "[parameters('location')]",
            "tags": "[variables('appTags')]",
            "sku": {
                "name": "[parameters('storageAccountType')]"
            },
            "resources": [
                {
                    "type": "tableServices/tables",
                    "apiVersion": "2019-06-01",
                    "name": "[concat('default/', 'chunk')]",
                    "dependsOn": [
                        "[variables('storageAccountName')]"
                    ]
                },
                {
                    "type": "tableServices/tables",
                    "apiVersion": "2019-06-01",
                    "name": "[concat('default/', 'export')]",
                    "dependsOn": [
                        "[variables('storageAccountName')]"
                    ]
                }
            ],
            "kind": "Storage",
            "properties": {
                "supportsHttpsTrafficOnly": true,
                "defaultToOAuthAuthentication": true,
                "allowSharedKeyAccess": false
            }
        },
        {
            "type": "Microsoft.Web/serverfarms",
            "apiVersion": "2021-03-01",
            "name": "[variables('hostingPlanName')]",
            "location": "[parameters('location')]",
            "sku": {
                "name": "S1",
                "tier": "Standard"
            },
            "properties": {
                "reserved": false
            }
        },
        {
            "type": "Microsoft.Web/sites",
            "apiVersion": "2021-03-01",
            "name": "[variables('functionAppName')]",
            "location": "[parameters('location')]",
            "kind": "functionapp",
            "tags": "[variables('appTags')]",
            "identity": {
                "type": "SystemAssigned"
            },
            "properties": {
                "serverFarmId": "[resourceId('Microsoft.Web/serverfarms', variables('hostingPlanName'))]",
                "httpsOnly": true,
                "siteConfig": {
                    "alwaysOn": true
                }
            },
            "dependsOn": [
                "[resourceId('Microsoft.Insights/components', variables('applicationInsightsName'))]",
                "[resourceId('Microsoft.Web/serverfarms', variables('hostingPlanName'))]",
                "[resourceId('Microsoft.Storage/storageAccounts', variables('storageAccountName'))]"
            ]
        },
        {
            "type": "Microsoft.Web/sites/config",
            "apiVersion": "2020-12-01",
            "name": "[format('{0}/{1}', variables('functionAppName'), 'appsettings')]",
            "location": "[parameters('location')]",
            "properties": {
                "AzureWebJobsStorage__accountname": "[variables('storageAccountName')]",
                "FUNCTIONS_EXTENSION_VERSION": "~4",
                "FUNCTIONS_WORKER_RUNTIME": "dotnet-isolated",
                "APPINSIGHTS_INSTRUMENTATIONKEY": "[reference(resourceId('Microsoft.Insights/components', variables('applicationInsightsName')), '2020-02-02').InstrumentationKey]",
                "APPLICATIONINSIGHTS_CONNECTION_STRING": "[reference(resourceId('Microsoft.Insights/components', variables('applicationInsightsName')), '2020-02-02').ConnectionString]",
                "AZURE_AppInsightConnectionstring": "[reference(resourceId('Microsoft.Insights/components', variables('applicationInsightsName')), '2020-02-02').ConnectionString]",
                "AZURE_DestinationUri": "[format('https://{0}.fhir.azurehealthcareapis.com', replace(parameters('fhirServiceName'), '/', '-'))]",
                "AZURE_SourceUri": "[format('https://{0}.azurehealthcareapis.com', parameters('apiForFhirName'))]",
                "AZURE_ScheduleInterval": "2",
                "AZURE_ImportMode": "IncrementalLoad",
                "AZURE_DeepCheckCount": "1",
                "AZURE_UserAgent": "FhirMigrationTool",
                "AZURE_SourceHttpClient": "SourceFhirEndpoint",
                "AZURE_DestinationHttpClient": "DestinationFhirEndpoint",
                "AZURE_ExportTableName": "export",
                "AZURE_ChunkTableName": "chunk",
                "AZURE_ExportChunkTime": "30",
                "AZURE_ExportWithHistory": "[parameters('exportWithHistory')]",
                "AZURE_ExportWithDelete": "[parameters('exportWithDelete')]",
                "AZURE_IsParallel": "[parameters('isParallel')]",
                "AZURE_ExportDeidentified":"[parameters('exportDeidentified')]",
                "AZURE_ConfigFile":"[parameters('configFile')]",
                "AZURE_stagingStorageAccountName": "[variables('storageAccountName')]",
                "AZURE_StagingStorageUri": "[format('https://{0}.table.core.windows.net', variables('storageAccountName'))]",
                "AZURE_BlobStorageUri": "[format('https://{0}.blob.core.windows.net', variables('storageAccountName'))]",
                "SCM_DO_BUILD_DURING_DEPLOYMENT": true,
                "ENABLE_ORYX_BUILD": true,
                "WEBSITE_RUN_FROM_PACKAGE": "0"
            },
            "dependsOn": [
                "[resourceId('Microsoft.Insights/components', variables('applicationInsightsName'))]",
                "[resourceId('Microsoft.Storage/storageAccounts', variables('storageAccountName'))]",
                "[resourceId('Microsoft.Web/sites', variables('functionAppName'))]"
            ]
        },
        {
            "type": "Microsoft.Web/sites/sourcecontrols",
            "apiVersion": "2021-03-01",
            "name": "[format('{0}/{1}', variables('functionAppName'), 'web')]",
            "properties": {
                "repoUrl": "[variables('repoUrl')]",
                "branch": "personal/v-nikitaraut-export-deidentified",
                "isManualIntegration": true
            },
            "dependsOn": [
                "[resourceId('Microsoft.Web/sites', variables('functionAppName'))]"
            ],
            "metadata": {
                "description": "Uses source control to deploy"
            }
        },
        {
            "type": "Microsoft.Insights/components",
            "apiVersion": "2020-02-02",
            "name": "[variables('applicationInsightsName')]",
            "location": "[parameters('appInsightsLocation')]",
            "kind": "web",
            "properties": {
                "Application_Type": "web",
                "Request_Source": "rest"
            }
        },
        {
            "type": "Microsoft.Authorization/roleAssignments",
            "apiVersion": "2022-04-01",
            "name": "[guid(variables('storageAccountName'),subscriptionResourceId('Microsoft.Authorization/roleDefinitions', '0a9a7e1f-b9d0-4cc4-a60d-0319b160aaa3'))]",
            "scope": "[concat('Microsoft.Storage/storageAccounts', '/', variables('storageAccountName'))]",
            "dependsOn": [
                "[variables('storageAccountName')]"
            ],
            "properties": {
                "roleDefinitionId": "[subscriptionResourceId('Microsoft.Authorization/roleDefinitions', '0a9a7e1f-b9d0-4cc4-a60d-0319b160aaa3')]",
                "principalId": "[reference(resourceId('Microsoft.Web/sites', variables('functionAppName')), '2021-03-01', 'full').identity.principalId]"
            }
        },
        {
            "type": "Microsoft.Authorization/roleAssignments",
            "apiVersion": "2022-04-01",
            "name": "[guid(variables('storageAccountName'),subscriptionResourceId('Microsoft.Authorization/roleDefinitions', 'ba92f5b4-2d11-453d-a403-e96b0029c9fe'))]",
            "scope": "[concat('Microsoft.Storage/storageAccounts', '/', variables('storageAccountName'))]",
            "dependsOn": [
                "[variables('storageAccountName')]"
            ],
            "properties": {
                "roleDefinitionId": "[subscriptionResourceId('Microsoft.Authorization/roleDefinitions', 'ba92f5b4-2d11-453d-a403-e96b0029c9fe')]",
                "principalId": "[reference(resourceId('Microsoft.Web/sites', variables('functionAppName')), '2021-03-01', 'full').identity.principalId]"
            }
        },
        {
            "type": "Microsoft.Authorization/roleAssignments",
            "apiVersion": "2022-04-01",
            "name": "[guid(variables('storageAccountName'),subscriptionResourceId('Microsoft.Authorization/roleDefinitions', '17d1049b-9a84-46fb-8f53-869881c3d3ab'))]",
            "scope": "[concat('Microsoft.Storage/storageAccounts', '/', variables('storageAccountName'))]",
            "dependsOn": [
                "[variables('storageAccountName')]"
            ],
            "properties": {
                "roleDefinitionId": "[subscriptionResourceId('Microsoft.Authorization/roleDefinitions', '17d1049b-9a84-46fb-8f53-869881c3d3ab')]",
                "principalId": "[reference(resourceId('Microsoft.Web/sites', variables('functionAppName')), '2021-03-01', 'full').identity.principalId]"
            }
        },
        {
            "type": "Microsoft.Authorization/roleAssignments",
            "apiVersion": "2022-04-01",
            "name": "[guid(variables('storageAccountName'),subscriptionResourceId('Microsoft.Authorization/roleDefinitions', 'b7e6dc6d-f1e8-4753-8033-0f276bb0955b'))]",
            "scope": "[concat('Microsoft.Storage/storageAccounts', '/', variables('storageAccountName'))]",
            "dependsOn": [
                "[variables('storageAccountName')]"
            ],
            "properties": {
                "roleDefinitionId": "[subscriptionResourceId('Microsoft.Authorization/roleDefinitions', 'b7e6dc6d-f1e8-4753-8033-0f276bb0955b')]",
                "principalId": "[reference(resourceId('Microsoft.Web/sites', variables('functionAppName')), '2021-03-01', 'full').identity.principalId]"
            }
        },
        {
            "type": "Microsoft.Authorization/roleAssignments",
            "apiVersion": "2022-04-01",
            "name": "[guid(variables('storageAccountName'),subscriptionResourceId('Microsoft.Authorization/roleDefinitions', '974c5e8b-45b9-4653-ba55-5f855dd0fb88'))]",
            "scope": "[concat('Microsoft.Storage/storageAccounts', '/', variables('storageAccountName'))]",
            "dependsOn": [
                "[variables('storageAccountName')]"
            ],
            "properties": {
                "roleDefinitionId": "[subscriptionResourceId('Microsoft.Authorization/roleDefinitions', '974c5e8b-45b9-4653-ba55-5f855dd0fb88')]",
                "principalId": "[reference(resourceId('Microsoft.Web/sites', variables('functionAppName')), '2021-03-01', 'full').identity.principalId]"
            }
        },
        {
            "type": "Microsoft.Resources/deployments",
            "apiVersion": "2022-09-01",
            "name": "migration-function-fhir-managed-id-role-assignment",
            "subscriptionId": "[variables('apiForFhirsubid')]",
            "resourceGroup": "[variables('apiForFhirRg')]",
            "properties": {
                "expressionEvaluationOptions": {
                    "scope": "inner"
                },
                "mode": "Incremental",
                "parameters": {
                    "resourceId": {
                        "value": "[resourceId('Microsoft.HealthcareApis/services', parameters('apiForFhirName'))]"
                    },
                    "roleId": {
                        "value": "5a1fc7df-4bf1-4951-a576-89034ee01acd"
                    },
                    "principalId": {
                        "value": "[reference(resourceId('Microsoft.Web/sites', variables('functionAppName')), '2021-03-01', 'full').identity.principalId]"
                    },
                    "apiForFhirName": {
                        "value": "[parameters('apiForFhirName')]"
                    }
                },
                "template": {
                    "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "metadata": {
                        "_generator": {
                            "name": "bicep",
                            "version": "0.16.2.56959",
                            "templateHash": "15312434787615452365"
                        }
                    },
                    "parameters": {
                        "resourceId": {
                            "type": "string"
                        },
                        "roleId": {
                            "type": "string"
                        },
                        "principalId": {
                            "type": "string"
                        },
                        "principalType": {
                            "type": "string",
                            "defaultValue": "ServicePrincipal"
                        },
                        "apiForFhirName": {
                            "type": "string"
                        }
                    },
                    "resources": [
                        {
                            "type": "Microsoft.Authorization/roleAssignments",
                            "apiVersion": "2022-04-01",
                            "name": "[guid(parameters('resourceId'), parameters('principalId'), subscriptionResourceId('Microsoft.Authorization/roleDefinitions', parameters('roleId')),parameters('apiForFhirName'))]",
                            "scope": "[concat('Microsoft.HealthcareApis/services', '/', parameters('apiForFhirName'))]",
                            "properties": {
                                "roleDefinitionId": "[subscriptionResourceId('Microsoft.Authorization/roleDefinitions', '5a1fc7df-4bf1-4951-a576-89034ee01acd')]",
                                "principalId": "[parameters('principalId')]"
                            }
                        }
                    ]
                }
            },
            "dependsOn": [
                "[resourceId('Microsoft.Web/sites', variables('functionAppName'))]"
            ],
            "metadata": {
                "description": "Setup access between FHIR and the deployment script managed identity"
            }
        },
        {
            "type": "Microsoft.Resources/deployments",
            "apiVersion": "2022-09-01",
            "name": "functionFhirServiceRoleAssignment",
            "subscriptionId": "[variables('fhirsubid')]",
            "resourceGroup": "[variables('fhirRg')]",
            "properties": {
                "expressionEvaluationOptions": {
                    "scope": "inner"
                },
                "mode": "Incremental",
                "parameters": {
                    "roleId": {
                        "value": "5a1fc7df-4bf1-4951-a576-89034ee01acd"
                    },
                    "principalId": {
                        "value": "[reference(resourceId('Microsoft.Web/sites', variables('functionAppName')), '2021-03-01', 'full').identity.principalId]"
                    },
                    "workspaceName": {
                        "value": "[variables('workspaceName')]"
                    },
                    "fhirname": {
                        "value": "[variables('serviceName')]"
                    }
                },
                "template": {
                    "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "metadata": {
                        "_generator": {
                            "name": "bicep",
                            "version": "0.16.2.56959",
                            "templateHash": "15312434787615452365"
                        }
                    },
                    "parameters": {
                        "roleId": {
                            "type": "string"
                        },
                        "principalId": {
                            "type": "string"
                        },
                        "principalType": {
                            "type": "string",
                            "defaultValue": "ServicePrincipal"
                        },
                        "workspaceName": {
                            "type": "string"
                        },
                        "fhirname": {
                            "type": "string"
                        }
                    },
                    "resources": [
                        {
                            "type": "Microsoft.Authorization/roleAssignments",
                            "apiVersion": "2022-04-01",
                            "name": "[guid(parameters('principalId'), subscriptionResourceId('Microsoft.Authorization/roleDefinitions', parameters('roleId')),parameters('fhirname'))]",
                            "scope": "[concat('Microsoft.HealthcareApis/workspaces', '/', parameters('workspaceName'), '/','fhirservices','/' , parameters('fhirname'))]",
                            "properties": {
                                "roleDefinitionId": "[subscriptionResourceId('Microsoft.Authorization/roleDefinitions', '5a1fc7df-4bf1-4951-a576-89034ee01acd')]",
                                "principalId": "[parameters('principalId')]"
                            }
                        }
                    ]
                }
            },
            "dependsOn": [
                "[resourceId('Microsoft.Web/sites', variables('functionAppName'))]"
            ],
            "metadata": {
                "description": "Setup access between FHIR and the deployment script managed identity"
            }
        },
        {
            "type": "Microsoft.Resources/deployments",
            "apiVersion": "2022-09-01",
            "name": "dashboardDeploy",
            "properties": {
                "expressionEvaluationOptions": {
                    "scope": "inner"
                },
                "mode": "Incremental",
                "parameters": {
                    "applicationInsightsName": {
                        "value": "[variables('applicationInsightsName')]"
                    },
                    "location": {
                        "value": "[parameters('location')]"
                    },
                    "dashboardName": {
                        "value": "[parameters('dashboardName')]"
                    }
                },
                "template": {
                    "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "metadata": {
                        "_generator": {
                            "name": "bicep",
                            "version": "0.14.6.61914",
                            "templateHash": "18176765831885184910"
                        }
                    },
                    "parameters": {
                        "location": {
                            "type": "string",
                            "defaultValue": "[resourceGroup().location]"
                        },
                        "applicationInsightsName": {
                            "type": "string"
                        },
                        "dashboardName": {
                            "type": "string",
                            "defaultValue": "MigrationToolDashboard"
                        }
                    },
                    "resources": [
                        {
                            "type": "Microsoft.Portal/dashboards",
                            "apiVersion": "2020-09-01-preview",
                            "name": "[parameters('dashboardName')]",
                            "location": "[parameters('location')]",
                            "properties": {
                                "lenses": [
                                    {
                                        "order": 0,
                                        "parts": [
                                            {
                                                "position": {
                                                "x": 0,
                                                "y": 0,
                                                "colSpan": 8,
                                                "rowSpan": 2
                                                },
                                                "metadata": {
                                                "inputs": [],
                                                "type": "Extension/HubsExtension/PartType/MarkdownPart",
                                                "settings": {
                                                    "content": {
                                                     "content": "## Important reminder: Custom search parameters and $reindex\n\n- The FHIR Migration Tool will copy over custom search parameters from your Azure API for FHIR over to your Azure Health Data Services FHIR service at the very beginning of migration. \n- Once migration has started, if you wish to add any more custom search parameters after that, you must add them directly to the Azure Health Data Service FHIR service post-migration.\n-  Once all your custom search parameters are in Azure Health Data Service FHIR service (regardless of if they were added by the migration tool or manually), you will need to run $reindex post-migration in order to index the custom search parameters and be able to use them in live production.\n- Learn more about custom search parameters:\n[How to do custom search in FHIR service](https://learn.microsoft.com/en-us/azure/healthcare-apis/fhir/how-to-do-custom-search) \nand $reindex:\n[How to run a reindex job in FHIR service](https://learn.microsoft.com/en-us/azure/healthcare-apis/fhir/how-to-run-a-reindex)",
                                                     "title": "",
                                                    "subtitle": "",
                                                    "markdownSource": 1,
                                                    "markdownUri": ""
                                                    }
                                                }
                                                }
                                            },
                                            {
                                                "position": {
                                                   "x": 0,
                                                    "y": 2,
                                                    "colSpan": 4,
                                                    "rowSpan": 1
                                                },
                                                "metadata": {
                                                    "inputs": [],
                                                    "type": "Extension/HubsExtension/PartType/MarkdownPart",
                                                    "settings": {
                                                        "content": {
                                                            "content": "",
                                                            "title": "Export Operation Status",
                                                            "subtitle": "Status of Export Operations",
                                                            "markdownSource": 1,
                                                            "markdownUri": ""
                                                        }
                                                    },
                                                    "partHeader": {
                                                        "title": "Export Operation Status",
                                                        "subtitle": "Status of Export Operations"
                                                    }
                                                }
                                            },
                                            {
                                                "position": {
                                                     "x": 4,
                                                     "y": 2,
                                                     "colSpan": 4,
                                                     "rowSpan": 1
                                                },
                                                "metadata": {
                                                    "inputs": [],
                                                    "type": "Extension/HubsExtension/PartType/MarkdownPart",
                                                    "settings": {
                                                        "content": {
                                                            "content": "\n",
                                                            "title": "Import Operation Status",
                                                            "subtitle": "Status of Import Operations",
                                                            "markdownSource": 1,
                                                            "markdownUri": ""
                                                        }
                                                    },
                                                    "partHeader": {
                                                        "title": "Import Operation Status",
                                                        "subtitle": "Status of Import Operations"
                                                    }
                                                }
                                            },
                                            {
                                                "position": {
                                                    "x": 8,
                                                    "y": 0,
                                                    "colSpan": 2,
                                                    "rowSpan": 1
                                                },
                                                "metadata": {
                                                    "inputs": [
                                                        {
                                                            "name": "id",
                                                            "value": "[resourceId('Microsoft.Insights/components', parameters('applicationInsightsName'))]"
                                                        },
                                                        {
                                                            "name": "Version",
                                                            "value": "1.0"
                                                        }
                                                    ],
                                                    "type": "Extension/AppInsightsExtension/PartType/AspNetOverviewPinnedPart",
                                                    "asset": {
                                                        "idInputName": "id",
                                                        "type": "ApplicationInsights"
                                                    },
                                                    "defaultMenuItemId": "overview"
                                                }
                                            },
                                            {
                                                "position": {
                                                    "x": 10,
                                                    "y": 0,
                                                    "colSpan": 1,
                                                    "rowSpan": 1
                                                },
                                                "metadata": {
                                                    "inputs": [
                                                        {
                                                            "name": "ComponentId",
                                                            "value": {
                                                                "Name": "[parameters('applicationInsightsName')]",
                                                                "SubscriptionId": "[subscription().subscriptionId]",
                                                                "ResourceGroup": "[resourceGroup().name]"
                                                            }
                                                        },
                                                        {
                                                            "name": "Version",
                                                            "value": "1.0"
                                                        }
                                                    ],
                                                    "type": "Extension/AppInsightsExtension/PartType/ProactiveDetectionAsyncPart",
                                                    "asset": {
                                                        "idInputName": "ComponentId",
                                                        "type": "ApplicationInsights"
                                                    },
                                                    "defaultMenuItemId": "ProactiveDetection"
                                                }
                                            },
                                            {
                                                "position": {
                                                    "x": 11,
                                                    "y": 0,
                                                    "colSpan": 1,
                                                    "rowSpan": 1
                                                },
                                                "metadata": {
                                                    "inputs": [
                                                        {
                                                            "name": "ComponentId",
                                                            "value": {
                                                                "Name": "[parameters('applicationInsightsName')]",
                                                                "SubscriptionId": "[subscription().subscriptionId]",
                                                                "ResourceGroup": "[resourceGroup().name]"
                                                            }
                                                        },
                                                        {
                                                            "name": "ResourceId",
                                                            "value": "[resourceId('Microsoft.Insights/components', parameters('applicationInsightsName'))]"
                                                        }
                                                    ],
                                                    "type": "Extension/AppInsightsExtension/PartType/QuickPulseButtonSmallPart",
                                                    "asset": {
                                                        "idInputName": "ComponentId",
                                                        "type": "ApplicationInsights"
                                                    }
                                                }
                                            },
                                            {
                                                "position": {
                                                    "x": 12,
                                                    "y": 0,
                                                    "colSpan": 1,
                                                    "rowSpan": 1
                                                },
                                                "metadata": {
                                                    "inputs": [
                                                        {
                                                            "name": "ComponentId",
                                                            "value": {
                                                                "Name": "[parameters('applicationInsightsName')]",
                                                                "SubscriptionId": "[subscription().subscriptionId]",
                                                                "ResourceGroup": "[resourceGroup().name]"
                                                            }
                                                        },
                                                        {
                                                            "name": "TimeContext",
                                                            "value": {
                                                                "durationMs": 86400000,
                                                                "endTime": null,
                                                                "createdTime": "2018-05-04T01:20:33.345Z",
                                                                "isInitialTime": true,
                                                                "grain": 1,
                                                                "useDashboardTimeRange": false
                                                            }
                                                        },
                                                        {
                                                            "name": "Version",
                                                            "value": "1.0"
                                                        },
                                                        {
                                                            "name": "componentId",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "id",
                                                            "isOptional": true
                                                        }
                                                    ],
                                                    "type": "Extension/AppInsightsExtension/PartType/WebTestsPinnedPart",
                                                    "asset": {
                                                        "idInputName": "ComponentId",
                                                        "type": "ApplicationInsights"
                                                    }
                                                }
                                            },
                                            {
                                                "position": {
                                                    "x": 13,
                                                    "y": 0,
                                                    "colSpan": 1,
                                                    "rowSpan": 1
                                                },
                                                "metadata": {
                                                    "inputs": [
                                                        {
                                                            "name": "ComponentId",
                                                            "value": {
                                                                "Name": "[parameters('applicationInsightsName')]",
                                                                "SubscriptionId": "[subscription().subscriptionId]",
                                                                "ResourceGroup": "[resourceGroup().name]"
                                                            }
                                                        },
                                                        {
                                                            "name": "TimeContext",
                                                            "value": {
                                                                "durationMs": 86400000,
                                                                "endTime": null,
                                                                "createdTime": "2018-05-08T18:47:35.237Z",
                                                                "isInitialTime": true,
                                                                "grain": 1,
                                                                "useDashboardTimeRange": false
                                                            }
                                                        },
                                                        {
                                                            "name": "ConfigurationId",
                                                            "value": "78ce933e-e864-4b05-a27b-71fd55a6afad"
                                                        },
                                                        {
                                                            "name": "MainResourceId",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "ResourceIds",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "DataModel",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "UseCallerTimeContext",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "OverrideSettings",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "PartId",
                                                            "isOptional": true
                                                        }
                                                    ],
                                                    "type": "Extension/AppInsightsExtension/PartType/ApplicationMapPart",
                                                    "settings": {},
                                                    "asset": {
                                                        "idInputName": "ComponentId",
                                                        "type": "ApplicationInsights"
                                                    }
                                                }
                                            },
                                            {
                                                "position": {
                                                    "x": 0,
                                                    "y": 3,
                                                    "colSpan": 4,
                                                    "rowSpan": 2
                                                },
                                                "metadata": {
                                                    "inputs": [
                                                        {
                                                            "name": "resourceTypeMode",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "ComponentId",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "Scope",
                                                            "value": {
                                                                "resourceIds": [
                                                                    "[resourceId('Microsoft.Insights/components', parameters('applicationInsightsName'))]"
                                                                ]
                                                            },
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "PartId",
                                                            "value": "1098cba3-13b3-47ec-8892-e1246ad15a13",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "Version",
                                                            "value": "2.0",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "TimeRange",
                                                            "value": "P7D",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "DashboardId",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "DraftRequestParameters",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "Query",
                                                            "value": "customEvents\n| where name == \"Export\" and tostring(customDimensions.ExportStatus) == \"Completed\"\n| distinct  timestamp, tostring(customDimensions.ExportId)\n| order by timestamp desc\n| count\n",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "ControlType",
                                                            "value": "AnalyticsGrid",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "SpecificChart",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "PartTitle",
                                                            "value": "Analytics",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "PartSubTitle",
                                                            "value": "TestDurableFunc",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "Dimensions",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "LegendOptions",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "IsQueryContainTimeRange",
                                                            "value": false,
                                                            "isOptional": true
                                                        }
                                                    ],
                                                    "type": "Extension/Microsoft_OperationsManagementSuite_Workspace/PartType/LogsDashboardPart",
                                                    "settings": {
                                                        "content": {
                                                            "Query": "customEvents\n| where name == \"Export\" and tostring(customDimensions.ExportStatus) == \"Completed\"\n| distinct  timestamp, tostring(customDimensions.ExportId)\n| order by timestamp desc\n| count as SuccessfulExports\n\n"
                                                        }
                                                    },
                                                    "partHeader": {
                                                        "title": "Completed Exports",
                                                        "subtitle": "Count"
                                                    }
                                                }
                                            },
                                            {
                                                "position": {
                                                    "x": 4,
                                                    "y": 3,
                                                    "colSpan": 4,
                                                    "rowSpan": 2
                                                },
                                                "metadata": {
                                                    "inputs": [
                                                        {
                                                            "name": "resourceTypeMode",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "ComponentId",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "Scope",
                                                            "value": {
                                                                "resourceIds": [
                                                                    "[resourceId('Microsoft.Insights/components', parameters('applicationInsightsName'))]"
                                                                ]
                                                            },
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "PartId",
                                                            "value": "616c9d10-386f-4043-b713-4046a6768a0c",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "Version",
                                                            "value": "2.0",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "TimeRange",
                                                            "value": "P7D",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "DashboardId",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "DraftRequestParameters",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "Query",
                                                            "value": "customEvents\n| where name == \"Import\" and tostring(customDimensions.ImportStatus) == \"Completed\"\n| distinct  timestamp, tostring(customDimensions.ImportId)\n| order by timestamp desc\n| count as ImportSuccess\n",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "ControlType",
                                                            "value": "AnalyticsGrid",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "SpecificChart",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "PartTitle",
                                                            "value": "Analytics",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "PartSubTitle",
                                                            "value": "TestDurableFunc",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "Dimensions",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "LegendOptions",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "IsQueryContainTimeRange",
                                                            "value": false,
                                                            "isOptional": true
                                                        }
                                                    ],
                                                    "type": "Extension/Microsoft_OperationsManagementSuite_Workspace/PartType/LogsDashboardPart",
                                                    "settings": {},
                                                    "partHeader": {
                                                        "title": "Completed Imports",
                                                        "subtitle": "count"
                                                    }
                                                }
                                            },
                                            {
                                                "position": {
                                                    "x": 8,
                                                    "y": 1,
                                                    "colSpan": 3,
                                                    "rowSpan": 1
                                                },
                                                "metadata": {
                                                    "inputs": [],
                                                    "type": "Extension/HubsExtension/PartType/MarkdownPart",
                                                    "settings": {
                                                        "content": {
                                                            "settings": {
                                                                "content": "# Reliability",
                                                                "title": "",
                                                                "subtitle": ""
                                                            }
                                                        }
                                                    }
                                                }
                                            },
                                            {
                                                "position": {
                                                    "x": 11,
                                                    "y": 1,
                                                    "colSpan": 1,
                                                    "rowSpan": 1
                                                },
                                                "metadata": {
                                                    "inputs": [
                                                        {
                                                            "name": "ResourceId",
                                                            "value": "[resourceId('Microsoft.Insights/components', parameters('applicationInsightsName'))]"
                                                        },
                                                        {
                                                            "name": "DataModel",
                                                            "value": {
                                                                "version": "1.0.0",
                                                                "timeContext": {
                                                                    "durationMs": 86400000,
                                                                    "createdTime": "2018-05-04T23:42:40.072Z",
                                                                    "isInitialTime": false,
                                                                    "grain": 1,
                                                                    "useDashboardTimeRange": false
                                                                }
                                                            },
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "ConfigurationId",
                                                            "value": "8a02f7bf-ac0f-40e1-afe9-f0e72cfee77f",
                                                            "isOptional": true
                                                        }
                                                    ],
                                                    "type": "Extension/AppInsightsExtension/PartType/CuratedBladeFailuresPinnedPart",
                                                    "isAdapter": true,
                                                    "asset": {
                                                        "idInputName": "ResourceId",
                                                        "type": "ApplicationInsights"
                                                    },
                                                    "defaultMenuItemId": "failures"
                                                }
                                            },
                                            {
                                                "position": {
                                                    "x": 12,
                                                    "y": 1,
                                                    "colSpan": 3,
                                                    "rowSpan": 1
                                                },
                                                "metadata": {
                                                    "inputs": [],
                                                    "type": "Extension/HubsExtension/PartType/MarkdownPart",
                                                    "settings": {
                                                        "content": {
                                                            "settings": {
                                                                "content": "# Responsiveness\r\n",
                                                                "title": "",
                                                                "subtitle": ""
                                                            }
                                                        }
                                                    }
                                                }
                                            },
                                            {
                                                "position": {
                                                    "x": 15,
                                                    "y": 1,
                                                    "colSpan": 1,
                                                    "rowSpan": 1
                                                },
                                                "metadata": {
                                                    "inputs": [
                                                        {
                                                            "name": "ResourceId",
                                                            "value": "[resourceId('Microsoft.Insights/components', parameters('applicationInsightsName'))]"
                                                        },
                                                        {
                                                            "name": "DataModel",
                                                            "value": {
                                                                "version": "1.0.0",
                                                                "timeContext": {
                                                                    "durationMs": 86400000,
                                                                    "createdTime": "2018-05-04T23:43:37.804Z",
                                                                    "isInitialTime": false,
                                                                    "grain": 1,
                                                                    "useDashboardTimeRange": false
                                                                }
                                                            },
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "ConfigurationId",
                                                            "value": "2a8ede4f-2bee-4b9c-aed9-2db0e8a01865",
                                                            "isOptional": true
                                                        }
                                                    ],
                                                    "type": "Extension/AppInsightsExtension/PartType/CuratedBladePerformancePinnedPart",
                                                    "isAdapter": true,
                                                    "asset": {
                                                        "idInputName": "ResourceId",
                                                        "type": "ApplicationInsights"
                                                    },
                                                    "defaultMenuItemId": "performance"
                                                }
                                            },
                                            {
                                                "position": {
                                                    "x": 8,
                                                    "y": 2,
                                                    "colSpan": 4,
                                                    "rowSpan": 3
                                                },
                                                "metadata": {
                                                    "inputs": [
                                                        {
                                                            "name": "options",
                                                            "value": {
                                                                "chart": {
                                                                    "metrics": [
                                                                        {
                                                                            "resourceMetadata": {
                                                                                "id": "[resourceId('Microsoft.Insights/components', parameters('applicationInsightsName'))]"
                                                                            },
                                                                            "name": "requests/failed",
                                                                            "aggregationType": 7,
                                                                            "namespace": "microsoft.insights/components",
                                                                            "metricVisualization": {
                                                                                "displayName": "Failed requests",
                                                                                "color": "#EC008C"
                                                                            }
                                                                        }
                                                                    ],
                                                                    "title": "Failed requests",
                                                                    "visualization": {
                                                                        "chartType": 3,
                                                                        "legendVisualization": {
                                                                            "isVisible": true,
                                                                            "position": 2,
                                                                            "hideSubtitle": false
                                                                        },
                                                                        "axisVisualization": {
                                                                            "x": {
                                                                                "isVisible": true,
                                                                                "axisType": 2
                                                                            },
                                                                            "y": {
                                                                                "isVisible": true,
                                                                                "axisType": 1
                                                                            }
                                                                        }
                                                                    },
                                                                    "openBladeOnClick": {
                                                                        "openBlade": true,
                                                                        "destinationBlade": {
                                                                            "extensionName": "HubsExtension",
                                                                            "bladeName": "ResourceMenuBlade",
                                                                            "parameters": {
                                                                                "id": "[resourceId('Microsoft.Insights/components', parameters('applicationInsightsName'))]",
                                                                                "menuid": "failures"
                                                                            }
                                                                        }
                                                                    }
                                                                }
                                                            }
                                                        },
                                                        {
                                                            "name": "sharedTimeRange",
                                                            "isOptional": true
                                                        }
                                                    ],
                                                    "type": "Extension/HubsExtension/PartType/MonitorChartPart",
                                                    "settings": {
                                                        "content": {
                                                            "options": {
                                                                "chart": {
                                                                    "metrics": [
                                                                        {
                                                                            "resourceMetadata": {
                                                                                "id": "[resourceId('Microsoft.Insights/components', parameters('applicationInsightsName'))]"
                                                                            },
                                                                            "name": "requests/failed",
                                                                            "aggregationType": 7,
                                                                            "namespace": "microsoft.insights/components",
                                                                            "metricVisualization": {
                                                                                "displayName": "Failed requests",
                                                                                "color": "#EC008C"
                                                                            }
                                                                        }
                                                                    ],
                                                                    "title": "Failed requests",
                                                                    "visualization": {
                                                                        "chartType": 3,
                                                                        "legendVisualization": {
                                                                            "isVisible": true,
                                                                            "position": 2,
                                                                            "hideSubtitle": false
                                                                        },
                                                                        "axisVisualization": {
                                                                            "x": {
                                                                                "isVisible": true,
                                                                                "axisType": 2
                                                                            },
                                                                            "y": {
                                                                                "isVisible": true,
                                                                                "axisType": 1
                                                                            }
                                                                        },
                                                                        "disablePinning": true
                                                                    },
                                                                    "openBladeOnClick": {
                                                                        "openBlade": true,
                                                                        "destinationBlade": {
                                                                            "extensionName": "HubsExtension",
                                                                            "bladeName": "ResourceMenuBlade",
                                                                            "parameters": {
                                                                                "id": "[resourceId('Microsoft.Insights/components', parameters('applicationInsightsName'))]",
                                                                                "menuid": "failures"
                                                                            }
                                                                        }
                                                                    }
                                                                }
                                                            }
                                                        }
                                                    }
                                                }
                                            },
                                            {
                                                "position": {
                                                    "x": 12,
                                                    "y": 2,
                                                    "colSpan": 4,
                                                    "rowSpan": 3
                                                },
                                                "metadata": {
                                                    "inputs": [
                                                        {
                                                            "name": "options",
                                                            "value": {
                                                                "chart": {
                                                                    "metrics": [
                                                                        {
                                                                            "resourceMetadata": {
                                                                                "id": "[resourceId('Microsoft.Insights/components', parameters('applicationInsightsName'))]"
                                                                            },
                                                                            "name": "requests/duration",
                                                                            "aggregationType": 4,
                                                                            "namespace": "microsoft.insights/components",
                                                                            "metricVisualization": {
                                                                                "displayName": "Server response time",
                                                                                "color": "#00BCF2"
                                                                            }
                                                                        }
                                                                    ],
                                                                    "title": "Server response time",
                                                                    "visualization": {
                                                                        "chartType": 2,
                                                                        "legendVisualization": {
                                                                            "isVisible": true,
                                                                            "position": 2,
                                                                            "hideSubtitle": false
                                                                        },
                                                                        "axisVisualization": {
                                                                            "x": {
                                                                                "isVisible": true,
                                                                                "axisType": 2
                                                                            },
                                                                            "y": {
                                                                                "isVisible": true,
                                                                                "axisType": 1
                                                                            }
                                                                        }
                                                                    },
                                                                    "openBladeOnClick": {
                                                                        "openBlade": true,
                                                                        "destinationBlade": {
                                                                            "extensionName": "HubsExtension",
                                                                            "bladeName": "ResourceMenuBlade",
                                                                            "parameters": {
                                                                                "id": "[resourceId('Microsoft.Insights/components', parameters('applicationInsightsName'))]",
                                                                                "menuid": "performance"
                                                                            }
                                                                        }
                                                                    }
                                                                }
                                                            }
                                                        },
                                                        {
                                                            "name": "sharedTimeRange",
                                                            "isOptional": true
                                                        }
                                                    ],
                                                    "type": "Extension/HubsExtension/PartType/MonitorChartPart",
                                                    "settings": {
                                                        "content": {
                                                            "options": {
                                                                "chart": {
                                                                    "metrics": [
                                                                        {
                                                                            "resourceMetadata": {
                                                                                "id": "[resourceId('Microsoft.Insights/components', parameters('applicationInsightsName'))]"
                                                                            },
                                                                            "name": "requests/duration",
                                                                            "aggregationType": 4,
                                                                            "namespace": "microsoft.insights/components",
                                                                            "metricVisualization": {
                                                                                "displayName": "Server response time",
                                                                                "color": "#00BCF2"
                                                                            }
                                                                        }
                                                                    ],
                                                                    "title": "Server response time",
                                                                    "visualization": {
                                                                        "chartType": 2,
                                                                        "legendVisualization": {
                                                                            "isVisible": true,
                                                                            "position": 2,
                                                                            "hideSubtitle": false
                                                                        },
                                                                        "axisVisualization": {
                                                                            "x": {
                                                                                "isVisible": true,
                                                                                "axisType": 2
                                                                            },
                                                                            "y": {
                                                                                "isVisible": true,
                                                                                "axisType": 1
                                                                            }
                                                                        },
                                                                        "disablePinning": true
                                                                    },
                                                                    "openBladeOnClick": {
                                                                        "openBlade": true,
                                                                        "destinationBlade": {
                                                                            "extensionName": "HubsExtension",
                                                                            "bladeName": "ResourceMenuBlade",
                                                                            "parameters": {
                                                                                "id": "[resourceId('Microsoft.Insights/components', parameters('applicationInsightsName'))]",
                                                                                "menuid": "performance"
                                                                            }
                                                                        }
                                                                    }
                                                                }
                                                            }
                                                        }
                                                    }
                                                }
                                            },
                                            {
                                                "position": {
                                                    "x": 0,
                                                    "y": 5,
                                                    "colSpan": 4,
                                                    "rowSpan": 2
                                                },
                                                "metadata": {
                                                    "inputs": [
                                                        {
                                                            "name": "resourceTypeMode",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "ComponentId",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "Scope",
                                                            "value": {
                                                                "resourceIds": [
                                                                    "[resourceId('Microsoft.Insights/components', parameters('applicationInsightsName'))]"
                                                                ]
                                                            },
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "PartId",
                                                            "value": "1b2b0ee5-12d4-4196-8412-298d4e811702",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "Version",
                                                            "value": "2.0",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "TimeRange",
                                                            "value": "P7D",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "DashboardId",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "DraftRequestParameters",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "Query",
                                                            "value": "let completed = customEvents\n| where name == \"Export\" and tostring(customDimensions.ExportStatus) == \"Completed\"\n| distinct  endTime = timestamp, exportId = tostring(customDimensions.ExportId)\n| order by endTime desc;\nlet started = customEvents\n| where name == \"Export\" and tostring(customDimensions.ExportStatus) == \"Started\"\n| distinct  startTime = timestamp, exportId = tostring(customDimensions.ExportId)\n| order by startTime desc;\nlet result = completed\n| join kind=innerunique started on exportId;\nresult\n| distinct exportId, startTime, endTime\n",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "ControlType",
                                                            "value": "AnalyticsGrid",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "SpecificChart",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "PartTitle",
                                                            "value": "Analytics",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "PartSubTitle",
                                                            "value": "TestDurableFunc",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "Dimensions",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "LegendOptions",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "IsQueryContainTimeRange",
                                                            "value": false,
                                                            "isOptional": true
                                                        }
                                                    ],
                                                    "type": "Extension/Microsoft_OperationsManagementSuite_Workspace/PartType/LogsDashboardPart",
                                                    "settings": {
                                                        "content": {
                                                            "GridColumnsWidth": {
                                                                "exportId": "102.988px",
                                                                "startTime": "104.9884px"
                                                            },
                                                            "Query": "let completed = customEvents\n| where name == \"Export\" and tostring(customDimensions.ExportStatus) == \"Completed\"\n| distinct  endTime = timestamp, exportId = tostring(customDimensions.ExportId), resources = tostring(customDimensions.TotalResources)\n| order by endTime desc;\nlet started = customEvents\n| where name == \"Export\" and tostring(customDimensions.ExportStatus) == \"Started\"\n| distinct  startTime = timestamp, exportId = tostring(customDimensions.ExportId)\n| order by startTime desc;\nlet result = completed\n| join kind=innerunique started on exportId;\nresult\n| distinct exportId, startTime, endTime, resources\n\n"
                                                        }
                                                    },
                                                    "partHeader": {
                                                        "title": "Completed Exports",
                                                        "subtitle": "Details"
                                                    }
                                                }
                                            },
                                            {
                                                "position": {
                                                    "x": 4,
                                                    "y": 5,
                                                    "colSpan": 4,
                                                    "rowSpan": 2
                                                },
                                                "metadata": {
                                                    "inputs": [
                                                        {
                                                            "name": "resourceTypeMode",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "ComponentId",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "Scope",
                                                            "value": {
                                                                "resourceIds": [
                                                                    "[resourceId('Microsoft.Insights/components', parameters('applicationInsightsName'))]"
                                                                ]
                                                            },
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "PartId",
                                                            "value": "153409e2-4ba5-4980-8f8b-36050e1149e2",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "Version",
                                                            "value": "2.0",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "TimeRange",
                                                            "value": "P7D",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "DashboardId",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "DraftRequestParameters",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "Query",
                                                            "value": "let completed = customEvents\n| where name == \"Import\" and tostring(customDimensions.ImportStatus) == \"Completed\"\n| distinct  endTime = timestamp, importId = tostring(customDimensions.ImportId)\n| order by endTime desc;\nlet started = customEvents\n| where name == \"Import\" and tostring(customDimensions.ImportStatus) == \"Started\"\n| distinct  startTime = timestamp, importId = tostring(customDimensions.ImportId)\n| order by startTime desc;\nlet result = completed\n| join kind=innerunique started on importId;\nresult\n| distinct importId, startTime, endTime\n",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "ControlType",
                                                            "value": "AnalyticsGrid",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "SpecificChart",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "PartTitle",
                                                            "value": "Analytics",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "PartSubTitle",
                                                            "value": "TestDurableFunc",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "Dimensions",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "LegendOptions",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "IsQueryContainTimeRange",
                                                            "value": false,
                                                            "isOptional": true
                                                        }
                                                    ],
                                                    "type": "Extension/Microsoft_OperationsManagementSuite_Workspace/PartType/LogsDashboardPart",
                                                    "settings": {
                                                        "content": {
                                                            "Query": "let completed = customEvents\n| where name == \"Import\" and tostring(customDimensions.ImportStatus) == \"Completed\"\n| distinct  endTime = timestamp, importId = tostring(customDimensions.ImportId), resources = tostring(customDimensions.TotalImportResources)\n| order by endTime desc;\nlet started = customEvents\n| where name == \"Import\" and tostring(customDimensions.ImportStatus) == \"Started\"\n| distinct  startTime = timestamp, importId = tostring(customDimensions.ImportId)\n| order by startTime desc;\nlet result = completed\n| join kind=innerunique started on importId;\nresult\n| distinct importId, startTime, endTime, resources\n"
                                                        }
                                                    },
                                                    "partHeader": {
                                                        "title": "Completed Imports",
                                                        "subtitle": "Details"
                                                    }
                                                }
                                            },
                                            {
                                                "position": {
                                                    "x": 0,
                                                    "y": 7,
                                                    "colSpan": 4,
                                                    "rowSpan": 2
                                                },
                                                "metadata": {
                                                    "inputs": [
                                                        {
                                                            "name": "resourceTypeMode",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "ComponentId",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "Scope",
                                                            "value": {
                                                                "resourceIds": [
                                                                    "[resourceId('Microsoft.Insights/components', parameters('applicationInsightsName'))]"
                                                                ]
                                                            },
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "PartId",
                                                            "value": "12259543-3da2-4189-849d-f020687cd046",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "Version",
                                                            "value": "2.0",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "TimeRange",
                                                            "value": "P7D",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "DashboardId",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "DraftRequestParameters",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "Query",
                                                            "value": "let completed = customEvents\n| where name == \"Export\" and tostring(customDimensions.ExportStatus) == \"Completed\"\n| distinct  timestamp, exportId = tostring(customDimensions.ExportId)\n| order by timestamp desc;\nlet running = customEvents\n| where name == \"Export\" and tostring(customDimensions.ExportStatus) == \"Running\"\n| distinct  timestamp, exportId = tostring(customDimensions.ExportId)\n| order by timestamp desc;\nrunning\n| distinct exportId\n| join kind=leftanti completed on exportId\n| count as ExportRunning\n\n",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "ControlType",
                                                            "value": "AnalyticsGrid",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "SpecificChart",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "PartTitle",
                                                            "value": "Analytics",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "PartSubTitle",
                                                            "value": "TestDurableFunc",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "Dimensions",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "LegendOptions",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "IsQueryContainTimeRange",
                                                            "value": false,
                                                            "isOptional": true
                                                        }
                                                    ],
                                                    "type": "Extension/Microsoft_OperationsManagementSuite_Workspace/PartType/LogsDashboardPart",
                                                    "settings": {},
                                                    "partHeader": {
                                                        "title": "Running Exports",
                                                        "subtitle": "Count"
                                                    }
                                                }
                                            },
                                            {
                                                "position": {
                                                    "x": 4,
                                                    "y": 7,
                                                    "colSpan": 4,
                                                    "rowSpan": 2
                                                },
                                                "metadata": {
                                                    "inputs": [
                                                        {
                                                            "name": "resourceTypeMode",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "ComponentId",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "Scope",
                                                            "value": {
                                                                "resourceIds": [
                                                                    "[resourceId('Microsoft.Insights/components', parameters('applicationInsightsName'))]"
                                                                ]
                                                            },
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "PartId",
                                                            "value": "15470d03-113b-4182-b702-b6556d4447cc",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "Version",
                                                            "value": "2.0",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "TimeRange",
                                                            "value": "P7D",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "DashboardId",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "DraftRequestParameters",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "Query",
                                                            "value": "let completed = customEvents\n| where name == \"Import\" and tostring(customDimensions.ImportStatus) == \"Completed\"\n| distinct  timestamp, importId = tostring(customDimensions.ImportId)\n| order by timestamp desc;\nlet failed = customEvents\n| where name == \"Import\" and tostring(customDimensions.ImportStatus) == \"Failed\"\n| distinct  timestamp, importId = tostring(customDimensions.ImportId)\n| order by timestamp desc;\nlet running = customEvents\n| where name == \"Import\" and tostring(customDimensions.ImportStatus) == \"Running\"\n| distinct  timestamp, importId = tostring(customDimensions.ImportId)\n| order by timestamp desc;\nrunning\n| distinct importId\n| join kind=leftanti completed on importId\n| join kind=leftanti failed on importId\n| count as ImportRunning\n",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "ControlType",
                                                            "value": "AnalyticsGrid",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "SpecificChart",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "PartTitle",
                                                            "value": "Analytics",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "PartSubTitle",
                                                            "value": "TestDurableFunc",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "Dimensions",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "LegendOptions",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "IsQueryContainTimeRange",
                                                            "value": false,
                                                            "isOptional": true
                                                        }
                                                    ],
                                                    "type": "Extension/Microsoft_OperationsManagementSuite_Workspace/PartType/LogsDashboardPart",
                                                    "settings": {},
                                                    "partHeader": {
                                                        "title": "Running Imports",
                                                        "subtitle": "Count"
                                                    }
                                                }
                                            },
                                            {
                                                "position": {
                                                    "x": 8,
                                                    "y": 5,
                                                    "colSpan": 4,
                                                    "rowSpan": 3
                                                },
                                                "metadata": {
                                                    "inputs": [
                                                        {
                                                            "name": "options",
                                                            "value": {
                                                                "chart": {
                                                                    "metrics": [
                                                                        {
                                                                            "resourceMetadata": {
                                                                                "id": "[resourceId('Microsoft.Insights/components', parameters('applicationInsightsName'))]"
                                                                            },
                                                                            "name": "exceptions/server",
                                                                            "aggregationType": 7,
                                                                            "namespace": "microsoft.insights/components",
                                                                            "metricVisualization": {
                                                                                "displayName": "Server exceptions",
                                                                                "color": "#47BDF5"
                                                                            }
                                                                        },
                                                                        {
                                                                            "resourceMetadata": {
                                                                                "id": "[resourceId('Microsoft.Insights/components', parameters('applicationInsightsName'))]"
                                                                            },
                                                                            "name": "dependencies/failed",
                                                                            "aggregationType": 7,
                                                                            "namespace": "microsoft.insights/components",
                                                                            "metricVisualization": {
                                                                                "displayName": "Dependency failures",
                                                                                "color": "#7E58FF"
                                                                            }
                                                                        }
                                                                    ],
                                                                    "title": "Server exceptions and Dependency failures",
                                                                    "visualization": {
                                                                        "chartType": 2,
                                                                        "legendVisualization": {
                                                                            "isVisible": true,
                                                                            "position": 2,
                                                                            "hideSubtitle": false
                                                                        },
                                                                        "axisVisualization": {
                                                                            "x": {
                                                                                "isVisible": true,
                                                                                "axisType": 2
                                                                            },
                                                                            "y": {
                                                                                "isVisible": true,
                                                                                "axisType": 1
                                                                            }
                                                                        }
                                                                    }
                                                                }
                                                            }
                                                        },
                                                        {
                                                            "name": "sharedTimeRange",
                                                            "isOptional": true
                                                        }
                                                    ],
                                                    "type": "Extension/HubsExtension/PartType/MonitorChartPart",
                                                    "settings": {
                                                        "content": {
                                                            "options": {
                                                                "chart": {
                                                                    "metrics": [
                                                                        {
                                                                            "resourceMetadata": {
                                                                                "id": "[resourceId('Microsoft.Insights/components', parameters('applicationInsightsName'))]"
                                                                            },
                                                                            "name": "exceptions/server",
                                                                            "aggregationType": 7,
                                                                            "namespace": "microsoft.insights/components",
                                                                            "metricVisualization": {
                                                                                "displayName": "Server exceptions",
                                                                                "color": "#47BDF5"
                                                                            }
                                                                        },
                                                                        {
                                                                            "resourceMetadata": {
                                                                                "id": "[resourceId('Microsoft.Insights/components', parameters('applicationInsightsName'))]"
                                                                            },
                                                                            "name": "dependencies/failed",
                                                                            "aggregationType": 7,
                                                                            "namespace": "microsoft.insights/components",
                                                                            "metricVisualization": {
                                                                                "displayName": "Dependency failures",
                                                                                "color": "#7E58FF"
                                                                            }
                                                                        }
                                                                    ],
                                                                    "title": "Server exceptions and Dependency failures",
                                                                    "visualization": {
                                                                        "chartType": 2,
                                                                        "legendVisualization": {
                                                                            "isVisible": true,
                                                                            "position": 2,
                                                                            "hideSubtitle": false
                                                                        },
                                                                        "axisVisualization": {
                                                                            "x": {
                                                                                "isVisible": true,
                                                                                "axisType": 2
                                                                            },
                                                                            "y": {
                                                                                "isVisible": true,
                                                                                "axisType": 1
                                                                            }
                                                                        },
                                                                        "disablePinning": true
                                                                    }
                                                                }
                                                            }
                                                        }
                                                    }
                                                }
                                            },
                                            {
                                                "position": {
                                                    "x": 12,
                                                    "y": 5,
                                                    "colSpan": 4,
                                                    "rowSpan": 3
                                                },
                                                "metadata": {
                                                    "inputs": [
                                                        {
                                                            "name": "options",
                                                            "value": {
                                                                "chart": {
                                                                    "metrics": [
                                                                        {
                                                                            "resourceMetadata": {
                                                                                "id": "[resourceId('Microsoft.Insights/components', parameters('applicationInsightsName'))]"
                                                                            },
                                                                            "name": "performanceCounters/processorCpuPercentage",
                                                                            "aggregationType": 4,
                                                                            "namespace": "microsoft.insights/components",
                                                                            "metricVisualization": {
                                                                                "displayName": "Processor time",
                                                                                "color": "#47BDF5"
                                                                            }
                                                                        },
                                                                        {
                                                                            "resourceMetadata": {
                                                                                "id": "[resourceId('Microsoft.Insights/components', parameters('applicationInsightsName'))]"
                                                                            },
                                                                            "name": "performanceCounters/processCpuPercentage",
                                                                            "aggregationType": 4,
                                                                            "namespace": "microsoft.insights/components",
                                                                            "metricVisualization": {
                                                                                "displayName": "Process CPU",
                                                                                "color": "#7E58FF"
                                                                            }
                                                                        }
                                                                    ],
                                                                    "title": "Average processor and process CPU utilization",
                                                                    "visualization": {
                                                                        "chartType": 2,
                                                                        "legendVisualization": {
                                                                            "isVisible": true,
                                                                            "position": 2,
                                                                            "hideSubtitle": false
                                                                        },
                                                                        "axisVisualization": {
                                                                            "x": {
                                                                                "isVisible": true,
                                                                                "axisType": 2
                                                                            },
                                                                            "y": {
                                                                                "isVisible": true,
                                                                                "axisType": 1
                                                                            }
                                                                        }
                                                                    }
                                                                }
                                                            }
                                                        },
                                                        {
                                                            "name": "sharedTimeRange",
                                                            "isOptional": true
                                                        }
                                                    ],
                                                    "type": "Extension/HubsExtension/PartType/MonitorChartPart",
                                                    "settings": {
                                                        "content": {
                                                            "options": {
                                                                "chart": {
                                                                    "metrics": [
                                                                        {
                                                                            "resourceMetadata": {
                                                                                "id": "[resourceId('Microsoft.Insights/components', parameters('applicationInsightsName'))]"
                                                                            },
                                                                            "name": "performanceCounters/processorCpuPercentage",
                                                                            "aggregationType": 4,
                                                                            "namespace": "microsoft.insights/components",
                                                                            "metricVisualization": {
                                                                                "displayName": "Processor time",
                                                                                "color": "#47BDF5"
                                                                            }
                                                                        },
                                                                        {
                                                                            "resourceMetadata": {
                                                                                "id": "[resourceId('Microsoft.Insights/components', parameters('applicationInsightsName'))]"
                                                                            },
                                                                            "name": "performanceCounters/processCpuPercentage",
                                                                            "aggregationType": 4,
                                                                            "namespace": "microsoft.insights/components",
                                                                            "metricVisualization": {
                                                                                "displayName": "Process CPU",
                                                                                "color": "#7E58FF"
                                                                            }
                                                                        }
                                                                    ],
                                                                    "title": "Average processor and process CPU utilization",
                                                                    "visualization": {
                                                                        "chartType": 2,
                                                                        "legendVisualization": {
                                                                            "isVisible": true,
                                                                            "position": 2,
                                                                            "hideSubtitle": false
                                                                        },
                                                                        "axisVisualization": {
                                                                            "x": {
                                                                                "isVisible": true,
                                                                                "axisType": 2
                                                                            },
                                                                            "y": {
                                                                                "isVisible": true,
                                                                                "axisType": 1
                                                                            }
                                                                        },
                                                                        "disablePinning": true
                                                                    }
                                                                }
                                                            }
                                                        }
                                                    }
                                                }
                                            },
                                            {
                                                "position": {
                                                    "x": 0,
                                                    "y": 9,
                                                    "colSpan": 4,
                                                    "rowSpan": 2
                                                },
                                                "metadata": {
                                                    "inputs": [
                                                        {
                                                            "name": "resourceTypeMode",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "ComponentId",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "Scope",
                                                            "value": {
                                                                "resourceIds": [
                                                                    "[resourceId('Microsoft.Insights/components', parameters('applicationInsightsName'))]"
                                                                ]
                                                            },
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "PartId",
                                                            "value": "9b5e4e5b-bd38-4cd9-b8d6-32644404378b",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "Version",
                                                            "value": "2.0",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "TimeRange",
                                                            "value": "P7D",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "DashboardId",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "DraftRequestParameters",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "Query",
                                                            "value": "let completed = customEvents\n| where name == \"Export\" and tostring(customDimensions.ExportStatus) == \"Completed\"\n| distinct  timestamp, exportId = tostring(customDimensions.ExportId)\n| order by timestamp desc;\nlet failed = customEvents\n| where name == \"Export\" and tostring(customDimensions.ExportStatus) == \"Failed\"\n| distinct  timestamp, exportId = tostring(customDimensions.ExportId)\n| order by timestamp desc;\nlet running = customEvents\n| where name == \"Export\" and tostring(customDimensions.ExportStatus) == \"Running\"\n| distinct  lastUpdate=timestamp, exportId = tostring(customDimensions.ExportId)\n| order by lastUpdate desc;\nlet started = customEvents\n| where name == \"Export\" and tostring(customDimensions.ExportStatus) == \"Started\"\n| distinct  startTime=timestamp, exportId = tostring(customDimensions.ExportId)\n| order by startTime desc;\nlet result = running\n| join kind=leftanti completed on exportId\n| join kind=leftanti failed on exportId\n| join kind=innerunique started on exportId;\nresult\n| distinct exportId, startTime, lastUpdate\n\n",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "ControlType",
                                                            "value": "AnalyticsGrid",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "SpecificChart",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "PartTitle",
                                                            "value": "Analytics",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "PartSubTitle",
                                                            "value": "TestDurableFunc",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "Dimensions",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "LegendOptions",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "IsQueryContainTimeRange",
                                                            "value": false,
                                                            "isOptional": true
                                                        }
                                                    ],
                                                    "type": "Extension/Microsoft_OperationsManagementSuite_Workspace/PartType/LogsDashboardPart",
                                                    "settings": {},
                                                    "partHeader": {
                                                        "title": "Running Export Details",
                                                        "subtitle": "Details"
                                                    }
                                                }
                                            },
                                            {
                                                "position": {
                                                    "x": 4,
                                                    "y": 9,
                                                    "colSpan": 4,
                                                    "rowSpan": 2
                                                },
                                                "metadata": {
                                                    "inputs": [
                                                        {
                                                            "name": "resourceTypeMode",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "ComponentId",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "Scope",
                                                            "value": {
                                                                "resourceIds": [
                                                                    "[resourceId('Microsoft.Insights/components', parameters('applicationInsightsName'))]"
                                                                ]
                                                            },
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "PartId",
                                                            "value": "1cfc5c85-1848-49c4-8e1a-c0ffce147139",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "Version",
                                                            "value": "2.0",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "TimeRange",
                                                            "value": "P7D",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "DashboardId",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "DraftRequestParameters",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "Query",
                                                            "value": "let completed = customEvents\n| where name == \"Import\" and tostring(customDimensions.ImportStatus) == \"Completed\"\n| distinct  timestamp, importId = tostring(customDimensions.ImportId)\n| order by timestamp desc;\nlet failed = customEvents\n| where name == \"Import\" and tostring(customDimensions.ImportStatus) == \"Failed\"\n| distinct  timestamp, importId = tostring(customDimensions.ImportId)\n| order by timestamp desc;\nlet running = customEvents\n| where name == \"Import\" and tostring(customDimensions.ImportStatus) == \"Running\"\n| distinct  lastUpdate=timestamp, importId = tostring(customDimensions.ImportId)\n| order by lastUpdate desc;\nlet started = customEvents\n| where name == \"Import\" and tostring(customDimensions.ImportStatus) == \"Started\"\n| distinct  startTime=timestamp, importId = tostring(customDimensions.ImportId)\n| order by startTime desc;\nlet result = running\n| join kind=leftanti completed on importId\n| join kind=leftanti failed on importId\n| join kind=innerunique started on importId;\nresult\n| distinct importId, startTime, lastUpdate\n\n",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "ControlType",
                                                            "value": "AnalyticsGrid",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "SpecificChart",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "PartTitle",
                                                            "value": "Analytics",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "PartSubTitle",
                                                            "value": "TestDurableFunc",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "Dimensions",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "LegendOptions",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "IsQueryContainTimeRange",
                                                            "value": false,
                                                            "isOptional": true
                                                        }
                                                    ],
                                                    "type": "Extension/Microsoft_OperationsManagementSuite_Workspace/PartType/LogsDashboardPart",
                                                    "settings": {},
                                                    "partHeader": {
                                                        "title": "Running Imports",
                                                        "subtitle": "Details"
                                                    }
                                                }
                                            },
                                            {
                                                "position": {
                                                    "x": 8,
                                                    "y": 8,
                                                    "colSpan": 4,
                                                    "rowSpan": 3
                                                },
                                                "metadata": {
                                                    "inputs": [
                                                        {
                                                            "name": "options",
                                                            "value": {
                                                                "chart": {
                                                                    "metrics": [
                                                                        {
                                                                            "resourceMetadata": {
                                                                                "id": "[resourceId('Microsoft.Insights/components', parameters('applicationInsightsName'))]"
                                                                            },
                                                                            "name": "performanceCounters/processIOBytesPerSecond",
                                                                            "aggregationType": 4,
                                                                            "namespace": "microsoft.insights/components",
                                                                            "metricVisualization": {
                                                                                "displayName": "Process IO rate",
                                                                                "color": "#47BDF5"
                                                                            }
                                                                        }
                                                                    ],
                                                                    "title": "Average process I/O rate",
                                                                    "visualization": {
                                                                        "chartType": 2,
                                                                        "legendVisualization": {
                                                                            "isVisible": true,
                                                                            "position": 2,
                                                                            "hideSubtitle": false
                                                                        },
                                                                        "axisVisualization": {
                                                                            "x": {
                                                                                "isVisible": true,
                                                                                "axisType": 2
                                                                            },
                                                                            "y": {
                                                                                "isVisible": true,
                                                                                "axisType": 1
                                                                            }
                                                                        }
                                                                    }
                                                                }
                                                            }
                                                        },
                                                        {
                                                            "name": "sharedTimeRange",
                                                            "isOptional": true
                                                        }
                                                    ],
                                                    "type": "Extension/HubsExtension/PartType/MonitorChartPart",
                                                    "settings": {
                                                        "content": {
                                                            "options": {
                                                                "chart": {
                                                                    "metrics": [
                                                                        {
                                                                            "resourceMetadata": {
                                                                                "id": "[resourceId('Microsoft.Insights/components', parameters('applicationInsightsName'))]"
                                                                            },
                                                                            "name": "performanceCounters/processIOBytesPerSecond",
                                                                            "aggregationType": 4,
                                                                            "namespace": "microsoft.insights/components",
                                                                            "metricVisualization": {
                                                                                "displayName": "Process IO rate",
                                                                                "color": "#47BDF5"
                                                                            }
                                                                        }
                                                                    ],
                                                                    "title": "Average process I/O rate",
                                                                    "visualization": {
                                                                        "chartType": 2,
                                                                        "legendVisualization": {
                                                                            "isVisible": true,
                                                                            "position": 2,
                                                                            "hideSubtitle": false
                                                                        },
                                                                        "axisVisualization": {
                                                                            "x": {
                                                                                "isVisible": true,
                                                                                "axisType": 2
                                                                            },
                                                                            "y": {
                                                                                "isVisible": true,
                                                                                "axisType": 1
                                                                            }
                                                                        },
                                                                        "disablePinning": true
                                                                    }
                                                                }
                                                            }
                                                        }
                                                    }
                                                }
                                            },
                                            {
                                                "position": {
                                                    "x": 12,
                                                    "y": 8,
                                                    "colSpan": 4,
                                                    "rowSpan": 3
                                                },
                                                "metadata": {
                                                    "inputs": [
                                                        {
                                                            "name": "options",
                                                            "value": {
                                                                "chart": {
                                                                    "metrics": [
                                                                        {
                                                                            "resourceMetadata": {
                                                                                "id": "/subscriptions/a1766500-6fd5-4f5c-8515-607798271014/resourceGroups/migtool-deploy-rg/providers/Microsoft.Insights/components/miga2xl-appins"
                                                                            },
                                                                            "name": "performanceCounters/memoryAvailableBytes",
                                                                            "aggregationType": 4,
                                                                            "namespace": "microsoft.insights/components",
                                                                            "metricVisualization": {
                                                                                "displayName": "Available memory",
                                                                                "color": "#47BDF5"
                                                                            }
                                                                        }
                                                                    ],
                                                                    "title": "Average available memory",
                                                                    "visualization": {
                                                                        "chartType": 2,
                                                                        "legendVisualization": {
                                                                            "isVisible": true,
                                                                            "position": 2,
                                                                            "hideSubtitle": false
                                                                        },
                                                                        "axisVisualization": {
                                                                            "x": {
                                                                                "isVisible": true,
                                                                                "axisType": 2
                                                                            },
                                                                            "y": {
                                                                                "isVisible": true,
                                                                                "axisType": 1
                                                                            }
                                                                        }
                                                                    }
                                                                }
                                                            }
                                                        },
                                                        {
                                                            "name": "sharedTimeRange",
                                                            "isOptional": true
                                                        }
                                                    ],
                                                    "type": "Extension/HubsExtension/PartType/MonitorChartPart",
                                                    "settings": {
                                                        "content": {
                                                            "options": {
                                                                "chart": {
                                                                    "metrics": [
                                                                        {
                                                                            "resourceMetadata": {
                                                                                "id": "/subscriptions/a1766500-6fd5-4f5c-8515-607798271014/resourceGroups/migtool-deploy-rg/providers/Microsoft.Insights/components/miga2xl-appins"
                                                                            },
                                                                            "name": "performanceCounters/memoryAvailableBytes",
                                                                            "aggregationType": 4,
                                                                            "namespace": "microsoft.insights/components",
                                                                            "metricVisualization": {
                                                                                "displayName": "Available memory",
                                                                                "color": "#47BDF5"
                                                                            }
                                                                        }
                                                                    ],
                                                                    "title": "Average available memory",
                                                                    "visualization": {
                                                                        "chartType": 2,
                                                                        "legendVisualization": {
                                                                            "isVisible": true,
                                                                            "position": 2,
                                                                            "hideSubtitle": false
                                                                        },
                                                                        "axisVisualization": {
                                                                            "x": {
                                                                                "isVisible": true,
                                                                                "axisType": 2
                                                                            },
                                                                            "y": {
                                                                                "isVisible": true,
                                                                                "axisType": 1
                                                                            }
                                                                        },
                                                                        "disablePinning": true
                                                                    }
                                                                }
                                                            }
                                                        }
                                                    }
                                                }
                                            },
                                            {
                                                "position": {
                                                    "x": 0,
                                                    "y": 11,
                                                    "colSpan": 4,
                                                    "rowSpan": 2
                                                },
                                                "metadata": {
                                                    "inputs": [
                                                        {
                                                            "name": "resourceTypeMode",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "ComponentId",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "Scope",
                                                            "value": {
                                                                "resourceIds": [
                                                                    "[resourceId('Microsoft.Insights/components', parameters('applicationInsightsName'))]"
                                                                ]
                                                            },
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "PartId",
                                                            "value": "00d30db8-81a7-4822-a13b-dc0b7788b925",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "Version",
                                                            "value": "2.0",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "TimeRange",
                                                            "value": "P1D",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "DashboardId",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "DraftRequestParameters",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "Query",
                                                            "value": "customEvents\n| where name == \"Export\" and tostring(customDimensions.ExportStatus) == \"Failed\"\n| distinct  timestamp, tostring(customDimensions.ExportId)\n| order by timestamp desc\n| count as ExportFailed\n",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "ControlType",
                                                            "value": "AnalyticsGrid",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "SpecificChart",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "PartTitle",
                                                            "value": "Analytics",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "PartSubTitle",
                                                            "value": "TestDurableFunc",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "Dimensions",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "LegendOptions",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "IsQueryContainTimeRange",
                                                            "value": false,
                                                            "isOptional": true
                                                        }
                                                    ],
                                                    "type": "Extension/Microsoft_OperationsManagementSuite_Workspace/PartType/LogsDashboardPart",
                                                    "settings": {},
                                                    "partHeader": {
                                                        "title": "Failed Exports",
                                                        "subtitle": "Count"
                                                    }
                                                }
                                            },
                                            {
                                                "position": {
                                                    "x": 4,
                                                    "y": 11,
                                                    "colSpan": 4,
                                                    "rowSpan": 2
                                                },
                                                "metadata": {
                                                    "inputs": [
                                                        {
                                                            "name": "resourceTypeMode",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "ComponentId",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "Scope",
                                                            "value": {
                                                                "resourceIds": [
                                                                    "[resourceId('Microsoft.Insights/components', parameters('applicationInsightsName'))]"
                                                                ]
                                                            },
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "PartId",
                                                            "value": "103e3a28-027f-4a5e-9a32-641c70776900",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "Version",
                                                            "value": "2.0",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "TimeRange",
                                                            "value": "P7D",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "DashboardId",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "DraftRequestParameters",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "Query",
                                                            "value": "customEvents\n| where name == \"Import\" and tostring(customDimensions.ImportStatus) == \"Failed\"\n| distinct  timestamp, tostring(customDimensions.ImportId)\n| order by timestamp desc\n| count as ExportFailed\n",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "ControlType",
                                                            "value": "AnalyticsGrid",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "SpecificChart",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "PartTitle",
                                                            "value": "Analytics",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "PartSubTitle",
                                                            "value": "TestDurableFunc",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "Dimensions",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "LegendOptions",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "IsQueryContainTimeRange",
                                                            "value": false,
                                                            "isOptional": true
                                                        }
                                                    ],
                                                    "type": "Extension/Microsoft_OperationsManagementSuite_Workspace/PartType/LogsDashboardPart",
                                                    "settings": {
                                                        "content": {
                                                            "Query": "customEvents\n| where name == \"Import\" and tostring(customDimensions.ImportStatus) == \"Failed\"\n| distinct  timestamp, tostring(customDimensions.ImportId)\n| order by timestamp desc\n| count as ImportFailed\n\n"
                                                        }
                                                    },
                                                    "partHeader": {
                                                        "title": "Failed Imports",
                                                        "subtitle": "Count"
                                                    }
                                                }
                                            },
                                            {
                                                "position": {
                                                    "x": 8,
                                                    "y": 11,
                                                    "colSpan": 4,
                                                    "rowSpan": 3
                                                },
                                                "metadata": {
                                                    "inputs": [
                                                        {
                                                            "name": "options",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "sharedTimeRange",
                                                            "isOptional": true
                                                        }
                                                    ],
                                                    "type": "Extension/HubsExtension/PartType/MonitorChartPart",
                                                    "settings": {
                                                        "content": {
                                                            "options": {
                                                                "chart": {
                                                                    "metrics": [
                                                                        {
                                                                            "resourceMetadata": {
                                                                                "id": "[resourceId('Microsoft.Insights/components', parameters('applicationInsightsName'))]"
                                                                            },
                                                                            "name": "availabilityResults/count",
                                                                            "aggregationType": 1,
                                                                            "namespace": "microsoft.insights/components/kusto",
                                                                            "metricVisualization": {
                                                                                "displayName": "Availability test results count"
                                                                            }
                                                                        }
                                                                    ],
                                                                    "title": "Availability test results count",
                                                                    "titleKind": 2,
                                                                    "visualization": {
                                                                        "chartType": 2,
                                                                        "legendVisualization": {
                                                                            "isVisible": true,
                                                                            "position": 2,
                                                                            "hideSubtitle": false
                                                                        },
                                                                        "axisVisualization": {
                                                                            "x": {
                                                                                "isVisible": true,
                                                                                "axisType": 2
                                                                            },
                                                                            "y": {
                                                                                "isVisible": true,
                                                                                "axisType": 1
                                                                            }
                                                                        },
                                                                        "disablePinning": true
                                                                    }
                                                                }
                                                            }
                                                        }
                                                    }
                                                }
                                            },
                                            {
                                                "position": {
                                                    "x": 4,
                                                    "y": 15,
                                                    "colSpan": 4,
                                                    "rowSpan": 2
                                                },
                                                "metadata": {
                                                    "inputs": [
                                                        {
                                                            "name": "resourceTypeMode",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "ComponentId",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "Scope",
                                                            "value": {
                                                                "resourceIds": [
                                                                    "[resourceId('Microsoft.Insights/components', parameters('applicationInsightsName'))]"
                                                                ]
                                                            },
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "PartId",
                                                            "value": "54cdfb98-4fa8-4e4e-a348-a69c412b4a92",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "Version",
                                                            "value": "2.0",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "TimeRange",
                                                            "value": "P7D",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "DashboardId",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "DraftRequestParameters",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "Query",
                                                            "value": "customEvents\n| where name == \"SurfaceCheck\"\n| extend Resource = tostring(customDimensions.Resource)\n| extend SourceCount = tostring(customDimensions.SourceCount)\n| extend DestinationCount = tostring(customDimensions.DestinationCount)\n| extend Result= tostring(customDimensions.Result)\n| distinct timestamp,Resource,SourceCount,DestinationCount,Result\n| order by timestamp desc",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "ControlType",
                                                            "value": "AnalyticsGrid",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "SpecificChart",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "PartTitle",
                                                            "value": "Analytics",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "PartSubTitle",
                                                            "value": "TestDurableFunc",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "Dimensions",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "LegendOptions",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "IsQueryContainTimeRange",
                                                            "value": false,
                                                            "isOptional": true
                                                        }
                                                    ],
                                                    "type": "Extension/Microsoft_OperationsManagementSuite_Workspace/PartType/LogsDashboardPart",
                                                    "settings": {},
                                                    "partHeader": {
                                                        "title": "Surface Check",
                                                        "subtitle": "Results"
                                                    }
                                                }
                                            },
                                            {
                                                "position": {
                                                    "x": 0,
                                                    "y": 13,
                                                    "colSpan": 4,
                                                    "rowSpan": 2
                                                },
                                                "metadata": {
                                                    "inputs": [
                                                        {
                                                            "name": "resourceTypeMode",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "ComponentId",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "Scope",
                                                            "value": {
                                                                "resourceIds": [
                                                                    "[resourceId('Microsoft.Insights/components', parameters('applicationInsightsName'))]"
                                                                ]
                                                            },
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "PartId",
                                                            "value": "15214c4e-15eb-4021-af58-3b9b3da15352",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "Version",
                                                            "value": "2.0",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "TimeRange",
                                                            "value": "P7D",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "DashboardId",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "DraftRequestParameters",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "Query",
                                                            "value": "let completed = customEvents\n| where name == \"Export\" and tostring(customDimensions.ExportStatus) == \"Failed\"\n| distinct  endTime = timestamp, exportId = tostring(customDimensions.ExportId), reason = tostring(customDimensions.FailureReason)\n| order by endTime desc;\nlet started = customEvents\n| where name == \"Export\" and tostring(customDimensions.ExportStatus) == \"Started\"\n| distinct  startTime = timestamp, exportId = tostring(customDimensions.ExportId)\n| order by startTime desc;\nlet result = completed\n| join kind=innerunique started on exportId;\nresult\n| distinct exportId,reason, startTime, endTime\n\n",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "ControlType",
                                                            "value": "AnalyticsGrid",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "SpecificChart",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "PartTitle",
                                                            "value": "Analytics",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "PartSubTitle",
                                                            "value": "TestDurableFunc",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "Dimensions",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "LegendOptions",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "IsQueryContainTimeRange",
                                                            "value": false,
                                                            "isOptional": true
                                                        }
                                                    ],
                                                    "type": "Extension/Microsoft_OperationsManagementSuite_Workspace/PartType/LogsDashboardPart",
                                                    "settings": {},
                                                    "partHeader": {
                                                        "title": "Failed Exports",
                                                        "subtitle": "Details"
                                                    }
                                                }
                                            },
                                            {
                                                "position": {
                                                    "x": 4,
                                                    "y": 13,
                                                    "colSpan": 4,
                                                    "rowSpan": 2
                                                },
                                                "metadata": {
                                                    "inputs": [
                                                        {
                                                            "name": "resourceTypeMode",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "ComponentId",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "Scope",
                                                            "value": {
                                                                "resourceIds": [
                                                                    "[resourceId('Microsoft.Insights/components', parameters('applicationInsightsName'))]"
                                                                ]
                                                            },
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "PartId",
                                                            "value": "29a7fde8-5b4d-4337-a212-46dedf81383c",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "Version",
                                                            "value": "2.0",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "TimeRange",
                                                            "value": "P7D",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "DashboardId",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "DraftRequestParameters",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "Query",
                                                            "value": "let failed = customEvents\n| where name == \"Import\" and tostring(customDimensions.ImportStatus) == \"Failed\"\n| distinct  endTime = timestamp, importId = tostring(customDimensions.ImportId), reason = tostring(customDimensions.FailureReason)\n| order by endTime desc;\nlet started = customEvents\n| where name == \"Import\" and tostring(customDimensions.ImportStatus) == \"Started\"\n| distinct  startTime = timestamp, importId = tostring(customDimensions.ImportId)\n| order by startTime desc;\nlet result = failed\n| join kind=innerunique started on importId;\nresult\n| distinct importId,reason, startTime, endTime\n\n",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "ControlType",
                                                            "value": "AnalyticsGrid",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "SpecificChart",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "PartTitle",
                                                            "value": "Analytics",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "PartSubTitle",
                                                            "value": "TestDurableFunc",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "Dimensions",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "LegendOptions",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "IsQueryContainTimeRange",
                                                            "value": false,
                                                            "isOptional": true
                                                        }
                                                    ],
                                                    "type": "Extension/Microsoft_OperationsManagementSuite_Workspace/PartType/LogsDashboardPart",
                                                    "settings": {},
                                                    "partHeader": {
                                                        "title": "Failed Import",
                                                        "subtitle": "Details"
                                                    }
                                                }
                                            },
                                            {
                                                "position": {
                                                    "x": 0,
                                                    "y": 15,
                                                    "colSpan": 4,
                                                    "rowSpan": 2
                                                },
                                                "metadata": {
                                                    "inputs": [
                                                        {
                                                            "name": "resourceTypeMode",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "ComponentId",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "Scope",
                                                            "value": {
                                                                "resourceIds": [
                                                                    "[resourceId('Microsoft.Insights/components', parameters('applicationInsightsName'))]"
                                                                ]
                                                            },
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "PartId",
                                                            "value": "103e3a28-027f-4a5e-9a32-641c70776900",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "Version",
                                                            "value": "2.0",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "TimeRange",
                                                            "value": "P7D",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "DashboardId",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "DraftRequestParameters",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "Query",
                                                            "value": "customEvents\n| where name == \"Import\" and tostring(customDimensions.ImportStatus) == \"Failed\"\n| distinct  timestamp, tostring(customDimensions.ImportId)\n| order by timestamp desc\n| count as ExportFailed\n",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "ControlType",
                                                            "value": "AnalyticsGrid",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "SpecificChart",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "PartTitle",
                                                            "value": "Analytics",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "PartSubTitle",
                                                            "value": "TestDurableFunc",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "Dimensions",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "LegendOptions",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "IsQueryContainTimeRange",
                                                            "value": false,
                                                            "isOptional": true
                                                        }
                                                    ],
                                                    "type": "Extension/Microsoft_OperationsManagementSuite_Workspace/PartType/LogsDashboardPart",
                                                    "settings": {
                                                        "content": {
                                                            "Query": "customEvents \n| where name == \"Import\" and tostring(customDimensions.ImportStatus) == \"Completed\"\n| extend SourceResourceCount = tostring(customDimensions.SourceResourceCount)\n| extend DestinationResourceCount = tostring(customDimensions.DestinationResourceCount)\n| distinct timestamp, SourceResourceCount, DestinationResourceCount \n| order by timestamp desc\n| take 1"
                                                        }
                                                    },
                                                    "partHeader": {
                                                        "title": "Total Resource Count",
                                                        "subtitle": "Count"
                                                    }
                                                }
                                            },
                                            {
                                                "position": {
                                                    "x": 0,
                                                    "y": 17,
                                                    "colSpan": 4,
                                                    "rowSpan": 2
                                                },
                                                "metadata": {
                                                    "inputs": [
                                                        {
                                                            "name": "resourceTypeMode",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "ComponentId",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "Scope",
                                                            "value": {
                                                                "resourceIds": [
                                                                    "[resourceId('Microsoft.Insights/components', parameters('applicationInsightsName'))]"
                                                                ]
                                                            },
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "PartId",
                                                            "value": "103e3a28-027f-4a5e-9a32-641c70776900",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "Version",
                                                            "value": "2.0",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "TimeRange",
                                                            "value": "P7D",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "DashboardId",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "DraftRequestParameters",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "Query",
                                                            "value": "customEvents\n| where name == \"Import\" and tostring(customDimensions.ImportStatus) == \"Failed\"\n| distinct  timestamp, tostring(customDimensions.ImportId)\n| order by timestamp desc\n| count as ExportFailed\n",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "ControlType",
                                                            "value": "AnalyticsGrid",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "SpecificChart",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "PartTitle",
                                                            "value": "Analytics",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "PartSubTitle",
                                                            "value": "TestDurableFunc",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "Dimensions",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "LegendOptions",
                                                            "isOptional": true
                                                        },
                                                        {
                                                            "name": "IsQueryContainTimeRange",
                                                            "value": false,
                                                            "isOptional": true
                                                        }
                                                    ],
                                                    "type": "Extension/Microsoft_OperationsManagementSuite_Workspace/PartType/LogsDashboardPart",
                                                    "settings": {
                                                        "content": {
                                                            "Query": "customEvents | where name == \"Import\" and tostring(customDimensions.ImportStatus) == \"Completed\"\n| extend TotalExpoertedResources = tostring(customDimensions.TotalExportResources)\n| extend TotalImportResources = tostring(customDimensions.TotalImportResources)\n| distinct timestamp, TotalExpoertedResources, TotalImportResources\n| order by timestamp desc  \n"
                                                        }
                                                    },
                                                    "partHeader": {
                                                        "title": "Export and Import Resources",
                                                        "subtitle": "Details"
                                                    }
                                                }
                                            }
                                        ]
                                    }
                                ]
                            }
                        }
                    ]
                }
            }
        }
    ]
}
